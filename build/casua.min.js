(function(){var t,e,n,r,i,o,a,u,h,s,c,l,f,p,d,v=function(t,e){function n(){this.constructor=t}for(var r in e)g.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},g={}.hasOwnProperty;l=function(t,e){var n,r;null==e&&(e={});for(n in t)r=t[n],e[n]=r;return e},i={lt:"<",gt:">",quot:'"',amp:"&",apos:"'"},o={};for(p in i)d=i[p],o[d]=p;r=function(t){return t.replace(/[&<>"']/g,function(t){return"&"+o[t]+";"})},t=/^multiple|selected|checked|disabled|required|open$/,n="function"==typeof document.querySelectorAll,f={},f.Node=function(){function e(t){var e,n,r,i,o,a,h,s,c,l,p,d;if(this.handlers={},this.events={},this.length=0,t instanceof f.Node)return t;if("string"==typeof t)if("<"!==t.charAt(0))for(n=t.split(" "),d=n.shift(),o=document.createElement((l=d.match(/^([^\.^#]+)/))?l[1]:"div"),(l=d.match(/\.([^\.^#]+)/g))&&(o.className=l.join(" ").replace(/\./g,"")),(l=d.match(/#([^\.^#]+)/))&&(o.id=l[1]),u(this,o),a=0,h=n.length;h>a;a++)e=n[a],"#"!==e.charAt(0)&&(l=e.match(/^([^=]+)(?:=(['"])(.+?)\2)?$/))&&this.attr(l[1],l[3]||l[1]);else for(i=document.createElement("div"),i.innerHTML="<div>&#160;</div>"+t,i.removeChild(i.firstChild),p=i.childNodes,c=0,s=p.length;s>c;c++)r=p[c],u(this,r);else u(this,t)}var i,o,a,u,h,s;return u=function(t,e){var n,r,i,o;for(e.nodeName&&(e=[e]),o=[],r=0,i=e.length;i>r;r++)n=e[r],n._node=t,o.push(s(t,n));return o},s=function(t,e){return t[t.length]=e,t.length+=1},h=function(t,e){var n,r,i;return i=function(){var i,o,a;for(a=[],n=i=0,o=t.length;o>i;n=++i)r=t[n],a.push(e.call(r,n,r));return a}(),i[0]},i=window.document.addEventListener?function(t,e,n){return t.addEventListener(e,n,!1)}:function(t,e,n){return t.attachEvent("on"+e,n)},o=function(t,e){var n;return n=function(n,r){var i,o,a,u;n.preventDefault||(n.preventDefault=function(){return n.returnValue=!1}),n.stopPropagation||(n.stopPropagation=function(){return n.cancelBubble=!0}),n.target||(n.target=n.srcElement||document),null==n.defaultPrevented&&(u=n.preventDefault,n.preventDefault=function(){return n.defaultPrevented=!0,u.call(n)},n.defaultPrevented=!1),n.isDefaultPrevented=function(){return n.defaultPrevented||n.returnValue===!1},i=l(e[r||n.type]||[]);for(a in i)o=i[a],o.call(t,n);return delete n.preventDefault,delete n.stopPropagation,delete n.isDefaultPrevented},n.elem=t,n.handleds=[],n},a=/^focus$/,e.prototype.attr=function(e,n){return e=e.toLowerCase(),e.match(/^val|value$/)?this.val(n):e.match(t)?null!=n?(n?h(this,function(){return this.setAttribute(e,e),this[e]=!0}):h(this,function(){return this.removeAttribute(e),this[e]=!1}),this):this[0][e]:null!=n?(h(this,function(){return this.setAttribute(e,n)}),this):this[0].getAttribute(e,2)},e.prototype.append=function(t){return"string"==typeof t&&(t=new f.Node(t)),h(this,function(e,n){return h(t,function(t,e){return n.appendChild(e)})}),this},e.prototype.empty=function(){return h(this,function(){var t;for(t=[];this.firstChild;)t.push(this.removeChild(this.firstChild));return t}),this},e.prototype.html=function(t){return null!=t?(this.empty(),h(this,function(){return this.innerHTML=t}),this):this[0].innerHTML},e.prototype.text=function(t){return null!=t?this.html(r(t)):this.html()},e.prototype.on=function(t,e){var n,r;return n=this,(r=this.events)[t]||(r[t]=[]),this.events[t].push(e),h(this,function(e){var r,a,u;return u=(r=n.handlers)[e]||(r[e]=o(this,n.events)),a=u.handleds,-1===a.indexOf(t)?(i(this,t,u),a.push(t)):void 0}),this},e.prototype.trigger=function(t,e){var n;return null==e&&(e={}),t.match(a)&&(n=!0),h(this,function(){var r,i,o;r=document.createEvent("HTMLEvents"),r.initEvent(t,!0,!0);for(i in e)o=e[i],r[i]=o;return this.dispatchEvent(r),n?this[t]():void 0}),this},e.prototype.remove=function(){return h(this,function(){return this.parentNode?this.parentNode.removeChild(this):void 0}),this},e.prototype.replaceWith=function(t){return"string"==typeof t&&(t=new f.Node(t)),h(this,function(e,n){return h(t,function(t,e){return n.parentNode?n.parentNode.replaceChild(e,n):void 0})}),this},e.prototype.val=function(t){return null!=t?(h(this,function(){return this.value=t}),this):this[0].value},e.prototype.parent=function(){var t;return(t=this[0].parentNode)?t._node||new f.Node(t):void 0},e.prototype.find=function(t){var e;return e=n?this[0].querySelector(t):this[0].getElementsByTagName(t),e?e._node||new f.Node(e):void 0},e}(),s=function(t,e){return t._childs=[],null!=e?(-1===e._childs.indexOf(t)&&e._childs.push(t),t._parent=e):void 0},c=function(t,e){var n,r;return t._data[e]instanceof f.Scope&&(r=t._data[e],null!=r._parent&&(n=r._parent._childs.indexOf(r),r._parent._childs.splice(n,1))),u(t,t._data[e],e,"$delete")},u=function(t,e,n,r){var i,o,h,s,c,l,f,p,d;if("string"==typeof r&&"$"===r.charAt(0))return a(t,e,n,r);if(t._watches[r])for(f=t._watches[r],h=0,s=f.length;s>h;h++)o=f[h],o.call(t,e,n,r);for(p=t._childs,d=[],l=0,c=p.length;c>l;l++)i=p[l],d.push(null==i._data[r]?u(i,e,n,r):void 0);return d},a=function(t,e,n,r){var i,o,a,u,h;if(t._watches[r]){for(u=t._watches[r],h=[],o=0,a=u.length;a>o;o++)i=u[o],h.push(i.call(t,e,r,n));return h}},e=/^([^\.]+)\.(.+)$/,f.Scope=function(){function t(t,e){var n,r;if(t instanceof f.Scope)return t;if(null!=t.length)return new f.ArrayScope(t,e);s(this,e),this._watches={},this._data={};for(n in t)r=t[n],this.set(n,r)}return t.prototype.get=function(t){var n,r;return this._watch_lists&&-1===this._watch_lists.indexOf(t)&&this._watch_lists.push(t),"string"==typeof t&&(n=t.match(e))?this.get(n[1]).get(n[2]):"$parent"===t?this._parent:(r=this._data[t],null==r&&null!=this._parent&&(r=this._parent.get(t)),r)},t.prototype.set=function(t,n){var r,i;return"string"==typeof t&&(i=t.match(e))?this.get(i[1]).set(i[2],n):("string"!=typeof t||"$"!==t.charAt(0))&&("object"==typeof n&&(n=new f.Scope(n,this)),this._data[t]!==n&&(r=this._data[t],this._data[t]=n,null==r&&u(this,n,t,"$add"),u(this,n,r,t))),this},t.prototype.remove=function(t){var n;return"string"==typeof t&&(n=t.match(e))?this.get(n[1]).remove(n[2]):(c(this,t),delete this._data[t]),this},t.prototype.$watch=function(t,n){var r,i;return"string"==typeof t&&(i=t.match(e))?this.get(i[1]).$watch(i[2],n):((r=this._watches)[t]||(r[t]=[]),this._watches[t].push(n)),this},t.prototype.$startGetWatches=function(){return null!=this._parent&&this._parent.$startGetWatches(),this._watch_lists=[]},t.prototype.$stopGetWatches=function(){var t,e;return t=function(){var t,n,r,i;for(r=this._watch_lists,i=[],t=0,n=r.length;n>t;t++)e=r[t],i.push(e);return i}.call(this),delete this._watch_lists,null!=this._parent&&(t=t.concat(this._parent.$stopGetWatches())),t},t}(),h=function(t,e){var n,r;return n=t._data.length,r=e.call(t),u(t,t._data.length,n,"length"),r},f.ArrayScope=function(t){function e(t,e){var n,r,i,o;if(t instanceof f.Scope)return t;if(null==t.length)return new f.Scope(t,e);for(s(this,e),this._watches={},this._data=[],n=r=0,i=t.length;i>r;n=++r)o=t[n],this.set(n,o)}return v(e,t),e.prototype.length=function(){return this._data.length},e.prototype.indexOf=function(t){return this._data.indexOf(t)},e.prototype.remove=function(t){return h(this,function(){return c(this,t),this._data.splice(t,1)})},e.prototype.each=function(t){var e,n,r,i,o;for(o=this._data,e=n=0,r=o.length;r>n;e=++n)i=o[e],t.call(this,this.get(e),e);return this},e.prototype.pop=function(){return this.remove(this._data.length-1)[0]},e.prototype.shift=function(){return this.remove(0)[0]},e.prototype.push=function(){var t;return t=arguments,h(this,function(){var e,n,r;for(e=0,n=t.length;n>e;e++)r=t[e],this.set(this._data.length,r);return this._data.length})},e.prototype.unshift=function(){var t,e,n,r;return t=this._data.length,this.push.apply(this,arguments),r=function(){var r,i,o,a;for(o=this._data,a=[],e=r=0,i=o.length;i>r;e=++r)n=o[e],a.push(t>e?e+arguments.length:e-t);return a}.apply(this,arguments),u(this,r,null,"$move"),u(this,this._data.length,t,"length"),this._data.length},e.prototype.reverse=function(){var t,e,n;return this._data.reverse(),n=function(){var n,r,i,o;for(i=this._data,o=[],t=n=0,r=i.length;r>n;t=++n)e=i[t],o.push(this._data.length-1-t);return o}.call(this),u(this,n,null,"$move"),this},e.prototype.sort=function(t){var e,n,r,i,o;return i=this,o=function(){var t,r,i,o;for(i=this._data,o=[],e=t=0,r=i.length;r>t;e=++t)n=i[e],o.push({e:n,o:e});return o}.call(this),o.sort(function(e,n){return t.call(i,e.e,n.e)}),r=[],this._data=function(){var t,i,a;for(a=[],e=t=0,i=o.length;i>t;e=++t)n=o[e],r[n.o]=e,a.push(n.e);return a}(),u(this,r,null,"$move"),this},e.prototype.filter=function(t){var e,n,r,i,o,a,u,h,s,c;for(c=[],u=this._data,e=n=0,r=u.length;r>n;e=++n)a=u[e],t.call(this,a,e)||c.push(e);for(h=c.reverse(),s=[],o=0,i=h.length;i>o;o++)e=h[o],s.push(this.remove(e));return s},e}(f.Scope),f.defineController=function(e){var n,r,i,o,a,u,h,s,c,p,d,v,g,m,_,y;return _=function(t,e,n,i,o){var a,u,h,s,w,$,S,b,N,A;if(e instanceof f.ArrayScope)return y(t,e,n,i,o);if(o["@controller"])return $=l(o),w=new o["@controller"](e,t),delete $["@controller"],_(w,e,n,i,$);a=m(t,n,i),A=[];for(b in o)if(u=o[b],"@"===b.charAt(0)){if(N=b.toLowerCase().match(/^@(\w+)(?: (\S+))?$/))switch(N[1]){case"on":(h=u.match(r))&&(s=g(t,h[1]),n.on(N[2],function(t){return s.call(a,t,e)}));break;case"html":case"text":p(t,n,N[1],e,a,u);break;case"val":v(t,n,e,a,u);break;case"attr":c(t,n,N[2],e,a,u);break;case"class":c(t,n,N[1],e,a,u);break;case"child":_(t,e.get(N[2]),n,i,u);break;case"if":d(t,n,N[1],e,a,u);break;case"unless":d(t,n,N[1],e,a,u,!0)}}else N=b.match(/^(.*?)(?: \$(\S+))?(?: \#.*)?$/),S=new f.Node(N[1]),N[2]&&(i["$"+N[2]]=S),A.push(S),n.append(S),"object"==typeof u?_(t,e,S,i,u):p(t,S,"text",e,a,u);return A},y=function(t,e,n,r,i){var o,a;return n.empty(),o=[],a=function(e,a,u){var h;return h=l(r),o[u]=_(t,e,n,h,i)},e.$watch("$add",a),e.$watch("$delete",function(t,e,n){var r,i,a,u,h;for(u=o.splice(n,1)[0],h=[],r=0,i=u.length;i>r;r++)a=u[r],h.push(a.remove());return h}),e.$watch("$move",function(t){var e,r,i,a,u,h,s,c,l,f;for(e=[],l=r=0,i=t.length;i>r;l=++r)h=t[l],e[h]=o[l];for(o=e,n.empty(),f=[],u=0,a=o.length;a>u;u++)c=o[u],f.push(function(){var t,e,r;for(r=[],e=0,t=c.length;t>e;e++)s=c[e],r.push(n.append(s));return r}());return f}),e.each(function(t,e){return a.call({},t,null,e)})},m=function(t,e,n){var r,i,o,a,u,h,s;for(o={$node:function(t){return null!=t?"$"===t.charAt(0)?n[t]:n.$root.find(t):e}},h=t,r=o;h;){s=h.methods;for(u in s)a=s[u],i=a.bind(o),r[u]=i,o[u]||(o[u]=i);(h=h._parent)&&(r=r.$parent={})}return o},p=function(t,e,r,i,o,a){return n(t,i,o,a,function(t){return e[r].call(e,t)})},s=/^class$/,c=function(e,r,i,o,a,h){var c,l,f,p;return l=i.match(s)&&(c=r.attr(i))?c+" ":void 0,n(e,o,a,h,function(t){return null!=l&&(t=l+t),r.attr(i,t)}),i.match(t)&&(f=h.match(u))?(p=function(){return o.set(f[1],r.attr(i))},r.on("click",p)):void 0},v=function(t,e,n,i,o){var a,h,s,c,l,f,d,v,m;if(f=o.match(u))a=function(){return e.val(n.get(f[1]))},m=function(){return n.set(f[1],e.val())};else{if(!(f=o.match(r)))return p(t,_root,"val",n,i,child);l=g(t,f[1]),a=function(){return e.val(l.call(i))},m=function(){return l.call(i,e.val(),n)}}for(e.on("change",m),e.on("keyup",m),n.$startGetWatches(),a.call(n),d=n.$stopGetWatches(),v=[],s=0,c=d.length;c>s;s++)h=d[s],v.push(n.$watch(h,a));return v},d=function(t,e,r,i,o,a,u){var h,s,c;return null==u&&(u=!1),h=c=e,s=new f.Node("<!-- -->"),n(t,i,o,a,function(t){return u&&(t=!t),t?(h.replaceWith(c),h=c):(h.replaceWith(s),h=s)},!0)},a=/\{\{([\S^\}]+?)\}\}/g,o=/^\{\{([\S^\}]+?)\}\}$/,h=/@(\S+)/g,u=/^@(\S+)$/,i=/(\w\S*)\(\)/g,r=/^(\w\S*)\(\)$/,n=function(t,e,n,s,c,l){var ct,f,p,d,v,mm,m,_,y,sc,w;for(null==l&&(l=!1),w=(m=s.match(r))?(v=g(t,m[1]),function(){return c.call({},v.call(n,e))}):(m=s.match(u))?function(){return c.call({},this.get(m[1]))}:(m=s.match(a))?function(){var i;return i=this,c.call({},s.replace(a,function(a){return a=a.match(o),(m=a[1].match(r))?(v=g(t,m[1]),v.call(n,e)):(m=a[1].match(u))?i.get(m[1]):void 0}))}:l?(ct=n,sc=e,mm={},s=s.replace(i,function(e){return e=e.match(r),mm[e[1]]=g(t,e[1]),'mm["'+e[1]+'"].call(ct, sc)'}),s=s.replace(h,function(t){return t=t.match(u),'sc.get("'+t[1]+'")'}),function(){return c.call({},eval(s))}):function(){return c.call({},s)},e.$startGetWatches(),w.call(e),_=e.$stopGetWatches(),y=[],p=0,d=_.length;d>p;p++)f=_[p],y.push(e.$watch(f,w));return y},g=function(t,e){var n,r;for(n=t;;){if(r=null!=n.methods?n.methods[e]:void 0,null!=r)break;if(!(n=n._parent))break}return r},function(){function t(t,n){null==t&&(t={}),this._parent=n,this.scope=new f.Scope(t),this.methods=e.call(this,this.scope,this)}return t.prototype.renderAt=function(t,e){var n;return t=new f.Node(t).empty(),n={$root:t},_(this,this.scope,t,n,e)},t.prototype.render=function(t){var e;return e=new f.Node(document.createElement("div")),this.renderAt(e,t),e},t}()},window.casua=f}).call(this);